#
# SPDX-FileCopyrightText: The LineageOS Project
# SPDX-License-Identifier: Apache-2.0
#

on init
    # Display
    chmod 0666 /sys/devices/platform/display_id/brightnessid

    chown root system /sys/devices/platform/display_id/brightnessid

on post-fs-data
    # Audio
    mkdir /data/vendor/audio 0777 audioserver audio

    chmod 0444 /proc/asound/cards

    chown system system /proc/asound/cards

    # Camera
    copy /vendor/etc/camera/bokeh_caldata_uw_golden.bin /data/vendor/camera/bokeh_caldata_uw_golden.bin
    copy /mnt/vendor/persist/camera/bokeh_caldata_uw_persist.bin /data/vendor/camera/bokeh_caldata_uw_persist.bin

    chmod 0444 /data/vendor/camera/bokeh_caldata_uw_golden.bin
    chmod 0444 /data/vendor/camera/bokeh_caldata_uw_persist.bin
    chmod 0777 /vendor/etc/camera

    chown cameraserver audio /data/vendor/camera/bokeh_caldata_uw_golden.bin
    chown cameraserver audio /data/vendor/camera/bokeh_caldata_uw_persist.bin

    # Display
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_diff_data
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_edge_mode
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_fast_diff_mode
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_fod_mode
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_game_mode
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_gesture_mode
    chmod 0444 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_gesture_point
    chmod 0666 /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_pocket_mode

    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_diff_data
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_edge_mode
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_fast_diff_mode
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_fod_mode
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_game_mode
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_gesture_mode
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_gesture_point
    chown system system /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_pocket_mode

    # Fingerprint
    mkdir /data/vendor/goodix/

    chmod 0777 /data/vendor/goodix/
    chmod 0666 /sys/panel_feature/hbm_mode
    chmod 0666 /sys/panel_feature/ui_status

    chown system system /sys/panel_feature/ui_status

    # HDR
    chmod 0660 /sys/panel_feature/brightness_sync

    chown system system /sys/panel_feature/brightness_sync

    # LEDs
    chmod 664 /dev/led_strips
    chmod 444 /mnt/vendor/persist/color
    chmod 220 /sys/class/leds/aw20036_led/all_brightness
    chmod 220 /sys/class/leds/aw20036_led/all_white_brightness
    chmod 664 /sys/class/leds/aw20036_led/effect
    chmod 664 /sys/class/leds/aw20036_led/factory_test
    chmod 220 /sys/class/leds/aw20036_led/frame_brightness
    chmod 664 /sys/class/leds/aw20036_led/hwid
    chmod 664 /sys/class/leds/aw20036_led/imax
    chmod 664 /sys/class/leds/aw20036_led/operating_mode

    chown system system /dev/led_strips
    chown system system /mnt/vendor/persist/color
    chown system system /sys/class/leds/aw20036_led/all_brightness
    chown system system /sys/class/leds/aw20036_led/all_white_brightness
    chown system system /sys/class/leds/aw20036_led/dev_color
    chown system system /sys/class/leds/aw20036_led/effect
    chown system system /sys/class/leds/aw20036_led/factory_test
    chown system system /sys/class/leds/aw20036_led/frame_brightness
    chown system system /sys/class/leds/aw20036_led/hwid
    chown system system /sys/class/leds/aw20036_led/imax
    chown system system /sys/class/leds/aw20036_led/operating_mode
    chown system system /sys/class/leds/aw20036_led/single_brightness
    chown system system /sys/class/leds/aw20036_led/vip_notification

    # Vibrator
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/bypass
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/cali_f0
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/cali_re
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/version

    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/bypass
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/cali_f0
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/cali_re
    chmod 0666 /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/version

    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/bypass
    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/cali_f0
    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/cali_re
    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0034/version

    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/bypass
    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/cali_f0
    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/cali_re
    chown system system /sys/devices/platform/soc/11e82000.i2c/i2c-8/8-0035/version

on boot
    # Charger
    chown system system /proc/charger/area_id
    chown system system /proc/charger/camera_on
    chown system system /proc/charger/charge_pump_enable
    chown system system /proc/charger/chg_data_id
    chown system system /proc/charger/ibus_now
    chown system system /proc/charger/is_aging_test
    chown system system /proc/charger/maxchargingcurrent
    chown system system /proc/charger/maxchargingvoltage
    chown system system /proc/charger/nt_abnormal_status
    chown system system /proc/charger/nt_adp_power
    chown system system /proc/charger/nt_cp_ctrl
    chown system system /proc/charger/nt_data
    chown system system /proc/charger/nt_otg_enable
    chown system system /proc/charger/nt_qmax
    chown system system /proc/charger/nt_quse
    chown system system /proc/charger/nt_resistance
    chown system system	/proc/charger/real_soc
    chown system system	/proc/charger/scenario_fcc
    chown system system	/proc/charger/ship_mode
    chown system system	/proc/charger/typec_cc_orientation
    chown system system /proc/charger/usb/temp
    chown system system /proc/charger/usb_charger_en
    chown system system /proc/charger/usb_real_type
    chown system system /proc/charger/usb_temp
    chown system system /proc/charger/voltage_adc
    chown system system /sys/class/power_supply/mtk-master-charger/voltage_max

    chmod 0666 /proc/charger/area_id
    chmod 0666 /proc/charger/camera_on
    chmod 0666 /proc/charger/charge_pump_enable
    chmod 0444 /proc/charger/chg_data_id
    chmod 0444 /proc/charger/ibus_now
    chmod 0666 /proc/charger/is_aging_test
    chmod 0666 /proc/charger/nt_abnormal_status
    chmod 0444 /proc/charger/nt_adp_power
    chmod 0666 /proc/charger/nt_data
    chmod 0666 /proc/charger/nt_cp_ctrl
    chmod 0666 /proc/charger/nt_otg_enable
    chmod 0444 /proc/charger/nt_qmax
    chmod 0444 /proc/charger/nt_quse
    chmod 0444 /proc/charger/nt_resistance
    chmod 0444 /proc/charger/typec_cc_orientation
    chmod 0444 /proc/charger/real_soc
    chmod 0666 /proc/charger/scenario_fcc
    chmod 0666 /proc/charger/ship_mode
    chmod 0666 /proc/charger/usb_charger_en
    chmod 0666 /proc/charger/usb_real_type
    chmod 0444 /proc/charger/usb_temp
    chmod 0666 /proc/charger/usb/temp
    chmod 0666 /proc/charger/voltage_adc
    chmod 0664 /sys/class/power_supply/mtk-master-charger/voltage_max

    # Sensors
    chmod 0666 /sys/bus/i2c/drivers/awinic_sar/3-0012/aot
    chmod 0666 /sys/bus/i2c/drivers/gh621x/3-0017/manual_calibration

    # Vibrator (RichTap)
    chmod 0666 /sys/class/leds/vibrator/activate
    chmod 0666 /sys/class/leds/vibrator/brightness
    chmod 0666 /sys/class/leds/vibrator/cali
    chmod 0666 /sys/class/leds/vibrator/duration
    chmod 0666 /sys/class/leds/vibrator/enable
    chmod 0666 /sys/class/leds/vibrator/f0
    chmod 0666 /sys/class/leds/vibrator/f0_save
    chmod 0666 /sys/class/leds/vibrator/gain
    chmod 0666 /sys/class/leds/vibrator/index
    chmod 0666 /sys/class/leds/vibrator/loop
    chmod 0666 /sys/class/leds/vibrator/lra_resistance
    chmod 0666 /sys/class/leds/vibrator/play
    chmod 0666 /sys/class/leds/vibrator/playlist
    chmod 0666 /sys/class/leds/vibrator/ram_cali
    chmod 0666 /sys/class/leds/vibrator/ram_save
    chmod 0666 /sys/class/leds/vibrator/reg
    chmod 0666 /sys/class/leds/vibrator/reset
    chmod 0666 /sys/class/leds/vibrator/rtp
    chmod 0666 /sys/class/leds/vibrator/seq
    chmod 0666 /sys/class/leds/vibrator/state
    chmod 0666 /sys/class/leds/vibrator/stream_data
    chmod 0666 /sys/class/leds/vibrator/stream_start
    chmod 0666 /sys/class/leds/vibrator/vbat
    chmod 0666 /sys/class/leds/vibrator/vmax
    chmod 0666 /sys/class/leds/vibrator/waveform

    chown system system /sys/class/leds/vibrator/activate
    chown system system /sys/class/leds/vibrator/brightness
    chown system system /sys/class/leds/vibrator/cali
    chown system system /sys/class/leds/vibrator/duration
    chown system system /sys/class/leds/vibrator/enable
    chown system system /sys/class/leds/vibrator/f0
    chown system system /sys/class/leds/vibrator/f0_save
    chown system system /sys/class/leds/vibrator/gain
    chown system system /sys/class/leds/vibrator/index
    chown system system /sys/class/leds/vibrator/loop
    chown system system /sys/class/leds/vibrator/lra_resistance
    chown system system /sys/class/leds/vibrator/play
    chown system system /sys/class/leds/vibrator/playlist
    chown system system /sys/class/leds/vibrator/ram_cali
    chown system system /sys/class/leds/vibrator/ram_save
    chown system system /sys/class/leds/vibrator/reg
    chown system system /sys/class/leds/vibrator/reset
    chown system system /sys/class/leds/vibrator/rtp
    chown system system /sys/class/leds/vibrator/stream_data
    chown system system /sys/class/leds/vibrator/stream_start
    chown system system /sys/class/leds/vibrator/seq
    chown system system /sys/class/leds/vibrator/state
    chown system system /sys/class/leds/vibrator/vbat
    chown system system /sys/class/leds/vibrator/vmax
    chown system system /sys/class/leds/vibrator/waveform

    # WiFi
    setprop ro.boot.wificountrycode 00

# ATM
on property:sys.boot_completed=1 && property:ro.boot.atm=enable
    chmod 0775 /mnt/vendor/persist

on property:sys.boot_completed=1 && property:ro.boot.atm=enable && property:vendor.attest.keybox.chown=ready
    chown system system /mnt/vendor/persist/attest_keybox.so
    setprop vendor.attest.keybox.chown done

on property:sys.boot_completed=1 && property:ro.boot.atm=enable && property:vendor.attest.ids.chown=ready
    chown system system /mnt/vendor/persist/attestation_ids.so
    setprop vendor.attest.ids.chown done

# Display
on property:sys.touch.pocket_mode=*
    write /sys/devices/platform/soc/11013000.spi3/spi_master/spi3/spi3.0/fts_pocket_mode ${sys.touch.pocket_mode}
